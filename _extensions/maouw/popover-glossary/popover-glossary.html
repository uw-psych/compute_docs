<script src="https://unpkg.com/@popperjs/core@2"></script>
<script>
  const refs = document.querySelectorAll(".glossary-ref");

  refs.forEach((ref) => {
    const link = ref.querySelector(".glossary-link");
    const def = ref.querySelector(".glossary-def");
    const popperInstance = Popper.createPopper(ref, def, {
      placement: "auto",
    });

    function show() {
      // Make the def visible
      def.setAttribute("data-show", "");

      // Enable the event listeners
      popperInstance.setOptions((options) => ({
        ...options,
        modifiers: [
          ...options.modifiers,
          { name: "eventListeners", enabled: true },
        ],
      }));

      // Update its position
      popperInstance.update();
    }

    function hide() {
      // Hide the def
      def.removeAttribute("data-show");

      // Disable the event listeners
      popperInstance.setOptions((options) => ({
        ...options,
        modifiers: [
          ...options.modifiers,
          { name: "eventListeners", enabled: false },
        ],
      }));
    }

    const showEvents = ["click"];
    const hideEvents = ["blur"];

    showEvents.forEach((event) => {
      link.addEventListener(event, show);
    });

    hideEvents.forEach((event) => {
      link.addEventListener(event, hide);
    });
  });
</script>
